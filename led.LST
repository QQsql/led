C51 COMPILER V9.01   LED                                                                   04/24/2015 17:47:47 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE LED
OBJECT MODULE PLACED IN led.OBJ
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE led.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include "stc12c5a.h"
   2          #define uint unsigned int
   3          #define uchar unsigned char
   4          
   5          
   6          /*******************************************************************************
   7          *陇东学院字模，高电位有效，按列扫描显示，每个数据高位对应低层led
   8          *
   9          *******************************************************************************/
  10          
  11          uint code WORD[4][32]={
  12                                                          //陇    
  13                                                          {0x00,0x00,0x00,0x00,0xFE,0xFF,0x02,0x08,0x22,0x10,0xDA,0x88,0x06,0x47,0x10,0x30,
  14                                                          0x10,0x0E,0xFF,0x41,0x10,0x20,0xF0,0x3F,0x11,0x48,0x16,0x46,0x90,0x41,0x10,0x78},
  15                                                          //东
  16                                                          {0x00,0x00,0x00,0x00,0x08,0x20,0x88,0x11,0x48,0x09,0x28,0x05,0x18,0x41,0x0F,0x81,
  17                                                          0xE8,0x7F,0x08,0x01,0x08,0x01,0x08,0x05,0x08,0x09,0x08,0x11,0x08,0x20,0x00,0x00},
  18                                                           //学
  19                                                          {0x00,0x00,0x40,0x04,0x30,0x04,0x11,0x04,0x96,0x04,0x90,0x04,0x90,0x44,0x91,0x84,
  20                                                          0x96,0x7E,0x90,0x06,0x90,0x05,0x98,0x04,0x14,0x04,0x13,0x04,0x50,0x04,0x30,0x04},
  21                                                           //院
  22                                                          {0x00,0x00,0x00,0x00,0xFE,0xFF,0x22,0x04,0x5A,0x08,0x86,0x07,0x10,0x80,0x0C,0x41,
  23                                                          0x24,0x31,0x24,0x0F,0x25,0x01,0x26,0x01,0x24,0x3F,0x24,0x41,0x14,0x41,0x0C,0x71}
  24                                                  };
  25          
  26          
  27          
  28          
  29          /*******************************************************************************
  30          * 函 数 名         : Delay10ms
  31          * 函数功能                 : 延时函数，延时10ms
  32          * 输    入         : 无
  33          * 输    出         : 无
  34          *******************************************************************************/
  35          
  36          void Delay10ms(unsigned int c)   //误差 0us
  37          {
  38   1          unsigned char a, b;
  39   1      
  40   1              //--c已经在传递过来的时候已经赋值了，所以在for语句第一句就不用赋值了--//
  41   1          for (;c>0;c--)
  42   1              {
  43   2                      for (b=38;b>0;b--)
  44   2                      {
  45   3                              for (a=5;a>0;a--);
  46   3                      }
  47   2                 
  48   2              }
  49   1              
  50   1      }
  51          
  52          
  53          
  54          
  55          /*******************************************************************************
C51 COMPILER V9.01   LED                                                                   04/24/2015 17:47:47 PAGE 2   

  56          * 函 数 名         : int0_led
  57          * 函数功能                 : 外部中断0 处理子程序，显示字模内容
  58          * 输    入         : 无
  59          * 输    出         : 无
  60          * 说    明                 ：P3.2口低电平或下降沿触发
  61          *******************************************************************************/
  62          void int0_led(void) interrupt 0
  63          {
  64   1                      uchar i,j;      //循环变量
  65   1                      uint DOWN,UP;    //字模值，DOWN为P4,P5口对应的8位(P4口高四位，P5口低四位)，UP对应P2口8位
  66   1                
  67   1                      for(i=0;i<=3;i++)
  68   1                              for(j=0;j<=31;j++)
  69   1                                      {
  70   2                                              
  71   2                                              UP=WORD[i][j];
  72   2                                              DOWN=WORD[i][++j];  //字模数组里面紧跟着的两个数据对应一列
  73   2      
  74   2                                              
  75   2                                              P2=~UP;
  76   2                                              P4=~(DOWN&0x0f);        //数据低位对应高处的led灯
  77   2                                              P5=~((DOWN>>4)&0x0f);
  78   2                                                      
  79   2                                              Delay10ms(1);           //亮灯的时间长度，延时越长，扫点越宽
  80   2      
  81   2      
  82   2                                               P2=0xff;                       //关灯
  83   2                                               P4=0x0f;
  84   2                                               P5=0x0f;
  85   2                                      
  86   2                                                      
  87   2                                               Delay10ms(4);          //每列之间的时间间隔，调字宽
  88   2                                      }
  89   1               
  90   1                      
  91   1      }
  92          
  93          
  94          
  95          
  96          
  97          /*******************************************************************************
  98          * 函 数 名         : main
  99          * 函数功能                 : 主函数
 100          * 输    入         : 无
 101          * 输    出         : 无
 102          *******************************************************************************/
 103          
 104          
 105          void main(void)
 106          {
 107   1                              
 108   1                 IT0=1;  //外部中断0设置为下降沿触发方式，INT0'/P3.2口上的下降沿信号可以触发INT0中断
 109   1                 EX0=1;  //外部中断0中断允许位，EX0=1,允许外部中断0
 110   1                 EA=1;   //开全局中断
 111   1                
 112   1                while(1)
 113   1                 {
 114   2                         //初始化各管脚，灯全灭
 115   2                         P2=0xff;     
 116   2                         P4=0x0f;
 117   2                         P5=0x0f;
C51 COMPILER V9.01   LED                                                                   04/24/2015 17:47:47 PAGE 3   

 118   2                 }
 119   1                 
 120   1                
 121   1         
 122   1      
 123   1      
 124   1      }
 125          
 126          
 127          
 128          
 129          /**************************************************************************************
 130          * 芯片管脚对应的设备表，LED灯低电位有效
 131          *
 132          *
 133          *******IO口对应LED灯*********
 134          *    LED灯从高到低排列
 135          *
 136          *LED灯->IO口     |
 137          *L9->P2.0                
 138          *L10->P2.1
 139          *L11->P2.2
 140          *L12->P2.3
 141          *L13->P2.4
 142          *L14->P2.5
 143          *L15->P2.6
 144          *L16->P2.7
 145          *L38->P4.0
 146          *L39->P4.1
 147          *L40->P4.2
 148          *L41->P4.3
 149          *L42->P5.0
 150          *L43->p5.1
 151          *L44->P5.2
 152          *L45->P5.3
 153          ***********************
 154          
 155          
 156          *红外管+->P32
 157          ***************************************************************************************/
 158          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    237    ----
   CONSTANT SIZE    =    256    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
